syntax = "proto3";

service SimpleService {
    rpc GetChord(GetInfo) returns (stream GetChordReply);
    rpc GetNode(GetInfo) returns (GetNodeReply);
    rpc Save(SaveKey) returns (SaveReply);
    rpc Remove(RemFiKey) returns (RemoveReply);
    rpc Find(RemFiKey) returns (FindReply);
}

// Commands from client
/*
● get_info
Calls get_chord_info() if connected to a registry. Or get_finger_table() if connected
to a node.
*/
message GetInfo {
}

/*
key: some key
text: some “text” here
It tells the connected node to save the text with the given key. Prints the result.
*/
message SaveKey {
    int32 key = 1;
    string text = 2;
}

/*
It tells the connected node  
to remove the text with the given key/to find a node with the key.
*/
message RemFiKey {
    string key = 1;
}


// Reply for client

//Return list of tuples
message GetChordReply {
    int32 id = 1;
    string addr = 2;
}
// Return finger table
message GetNodeReply {
    repeated int32 table = 1;
}
// True if saved, false otherwise
message SaveReply {
    bool saved = 1;
    int32 id = 2;
}
// True if removed, false otherwise
message RemoveReply {
    bool removed = 1;
    int32 id = 2;
}
// True
message FindReply {
    bool found = 1;
    int32 id = 2;
}